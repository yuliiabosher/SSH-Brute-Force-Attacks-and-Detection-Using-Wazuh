<!-- Local rules -->

<!-- Modify it at your will. -->
<!-- Copyright (C) 2015, Wazuh Inc. -->

<!-- Example -->
<group name="local,syslog,sshd,">

  <!--
  Dec 10 01:02:02 host sshd[1234]: Failed none for root from 1.1.1.1 port 1066 ssh2
  -->
  <rule id="100001" level="5">
    <if_sid>5716</if_sid>
    <srcip>1.1.1.1</srcip>
    <description>sshd: authentication failed from IP 1.1.1.1.</description>
    <group>authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,</group>
  </rule>

</group>

<group name="ssh_auth_failure,">

  <rule id="100101" level="9">
    <if_sid>5760,40111,2501,5758</if_sid>
    <description>Multiple ssh authentication failures</description>
  </rule>
  <rule id="100100" level="10" frequency="10" timeframe="60">
    <if_matched_sid>100101</if_matched_sid>
    <same_srcip />
    <description>Multiple ssh authentication failures from the same IP</description>
    <options>no_full_log</options>
  </rule>

</group>

<group name="ssh_auth_failure,">

  <rule id="100102" level="10">
    <if_sid>5760,40111,2501,5758</if_sid>
    <match>root</match>
    <description>Multiple shh authentication failures</description>
  </rule>
  <rule id="100103" level="11" frequency="10" timeframe="60">
    <if_matched_sid>100102</if_matched_sid>
    <description>Multiple ssh authentication failures for root</description>
  </rule>

</group>

<group name="ssh_auth_failure,">

  <rule id="100104" level="13" frequency="10" timeframe="60">
    <if_sid>5715</if_sid>   
    <if_matched_sid>100101</if_matched_sid>
    <same_srcip />
    <description>Successful login after multiple ssh authentication failures from the same IP</description>
  </rule>

</group>

<group name="ssh_auth_failure,">

  <rule id="100105" level="14" frequency="10" timeframe="60">
    <if_sid>5715</if_sid>
    <if_matched_sid>100102</if_matched_sid>
    <description>Successful root logn after multiple ssh authentication failures for root from same IP</description>
  </rule>

</group>

<group name="ssh_auth_success,">

  <rule id="100106" level="9">
    <if_sid>5715</if_sid>
    <match>Accepted key</match>
    <description>Successful ssh key-based authentication</description>
  </rule>

</group>
    
